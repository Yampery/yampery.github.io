<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>博文整理</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-04-28T09:44:40.774Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Yampery</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://yoursite.com/2018/04/28/ykt_test_binding/"/>
    <id>http://yoursite.com/2018/04/28/ykt_test_binding/</id>
    <published>2018-04-28T09:30:22.702Z</published>
    <updated>2018-04-28T09:44:40.774Z</updated>
    
    <content type="html"><![CDATA[<h1 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h1><hr><h2 id="测试目标"><a href="#测试目标" class="headerlink" title="测试目标"></a>测试目标</h2><pre><code>1. 绑定接口性能：响应时长，并发量2. 历史表500w数据下事务的处理情况3. 压测过程线程状态4. 压测过程堆状态</code></pre><h2 id="当前状态"><a href="#当前状态" class="headerlink" title="当前状态"></a>当前状态</h2><pre><code>1. 号池总量：10000002. T_REGINFO总量：200063. T_REGINFOHIS总量：4884369</code></pre><h2 id="测试服务器"><a href="#测试服务器" class="headerlink" title="测试服务器"></a>测试服务器</h2><h3 id="系统版本"><a href="#系统版本" class="headerlink" title="系统版本"></a>系统版本</h3><pre><code>Linux testserver-centos 3.10.0-693.21.1.el7.x86_64 #1 SMP Wed Mar 7 19:03:37 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</code></pre><h3 id="CPU信息"><a href="#CPU信息" class="headerlink" title="CPU信息"></a>CPU信息</h3><pre><code>Intel(R) Xeon(R) CPU E5-2650 0 @ 2.00GHz    X32</code></pre><h3 id="内存信息"><a href="#内存信息" class="headerlink" title="内存信息"></a>内存信息</h3><pre><code>MemTotal:       16215504 kBMemFree:         5705052 kBMemAvailable:   10554240 kBBuffers:              28 kBCached:          5565036 kBSwapCached:       518972 kBActive:          5504676 kBInactive:        4168584 kBActive(anon):    2818640 kBInactive(anon):  2020616 kBActive(file):    2686036 kBInactive(file):  2147968 kBUnevictable:           0 kBMlocked:               0 kBSwapTotal:       8126460 kBSwapFree:        6607556 kBDirty:                84 kBWriteback:             0 kBAnonPages:       3626044 kBMapped:           218624 kBShmem:            731060 kBSlab:             564724 kBSReclaimable:     410288 kBSUnreclaim:       154436 kBKernelStack:       12608 kBPageTables:        77320 kBNFS_Unstable:          0 kBBounce:                0 kBWritebackTmp:          0 kBCommitLimit:    16234212 kBCommitted_AS:    7857184 kBVmallocTotal:   34359738367 kBVmallocUsed:      316296 kBVmallocChunk:   34350563324 kBHardwareCorrupted:     0 kBAnonHugePages:    110592 kBHugePages_Total:       0HugePages_Free:        0HugePages_Rsvd:        0HugePages_Surp:        0Hugepagesize:       2048 kBDirectMap4k:      363456 kBDirectMap2M:    14270464 kBDirectMap1G:     2097152 kB</code></pre><h2 id="数据服务器"><a href="#数据服务器" class="headerlink" title="数据服务器"></a>数据服务器</h2><h3 id="系统版本-1"><a href="#系统版本-1" class="headerlink" title="系统版本"></a>系统版本</h3><pre><code>Linux weihua2 2.6.32-573.18.1.el6.i686 #1 SMP Tue Feb 9 19:51:22 UTC 2016 i686 i686 i386 GNU/Linux</code></pre><h3 id="CPU信息-1"><a href="#CPU信息-1" class="headerlink" title="CPU信息"></a>CPU信息</h3><pre><code>Intel(R) Xeon(R) CPU E5-2650 0 @ 2.00GHz     X32</code></pre><h3 id="内存信息-1"><a href="#内存信息-1" class="headerlink" title="内存信息"></a>内存信息</h3><pre><code>MemTotal:        8130136 kBMemFree:         2471888 kBBuffers:          347776 kBCached:           604844 kBSwapCached:        28720 kBActive:          4093188 kBInactive:        1380972 kBActive(anon):    3596772 kBInactive(anon):   926380 kBActive(file):     496416 kBInactive(file):   454592 kBUnevictable:           0 kBMlocked:               0 kBHighTotal:       7435208 kBHighFree:        2288728 kBLowTotal:         694928 kBLowFree:          183160 kBSwapTotal:       8273916 kBSwapFree:        8214956 kBDirty:                28 kBWriteback:             0 kBAnonPages:       4493096 kBMapped:            33680 kBShmem:              1540 kBSlab:             102100 kBSReclaimable:      78500 kBSUnreclaim:        23600 kBKernelStack:        7672 kBPageTables:        14536 kBNFS_Unstable:          0 kBBounce:                0 kBWritebackTmp:          0 kBCommitLimit:    12338984 kBCommitted_AS:    5936384 kBVmallocTotal:     122880 kBVmallocUsed:        7400 kBVmallocChunk:      35868 kBHugePages_Total:       0HugePages_Free:        0HugePages_Rsvd:        0HugePages_Surp:        0Hugepagesize:       2048 kBDirectMap4k:       10232 kBDirectMap2M:      897024 kB</code></pre><h2 id="负载机"><a href="#负载机" class="headerlink" title="负载机"></a>负载机</h2><h3 id="系统版本-2"><a href="#系统版本-2" class="headerlink" title="系统版本"></a>系统版本</h3><pre><code>Linux weihua1 2.6.32-279.el6.i686 #1 SMP Fri Jun 22 10:59:55 UTC 2012 i686 i686 i386 GNU/Linux</code></pre><h3 id="cpu信息"><a href="#cpu信息" class="headerlink" title="cpu信息"></a>cpu信息</h3><pre><code>Intel(R) Xeon(R) CPU E5-2650 0 @ 2.00GHz  X32</code></pre><h3 id="内存信息-2"><a href="#内存信息-2" class="headerlink" title="内存信息"></a>内存信息</h3><pre><code>MemTotal:        8130520 kBMemFree:         5369356 kBBuffers:          256976 kBCached:          2222852 kBSwapCached:         7724 kBActive:          1667240 kBInactive:         853124 kBActive(anon):      15696 kBInactive(anon):    26080 kBActive(file):    1651544 kBInactive(file):   827044 kBUnevictable:           0 kBMlocked:               0 kBHighTotal:       7435208 kBHighFree:        5249168 kBLowTotal:         695312 kBLowFree:          120188 kBSwapTotal:       8273912 kBSwapFree:        8201640 kBDirty:              4080 kBWriteback:             0 kBAnonPages:         33944 kBMapped:            14192 kBShmem:              1240 kBSlab:             150052 kBSReclaimable:     130256 kBSUnreclaim:        19796 kBKernelStack:        6600 kBPageTables:         5184 kBNFS_Unstable:          0 kBBounce:                0 kBWritebackTmp:          0 kBCommitLimit:    12339172 kBCommitted_AS:     588200 kBVmallocTotal:     122880 kBVmallocUsed:        7064 kBVmallocChunk:      84064 kBHugePages_Total:       0HugePages_Free:        0HugePages_Rsvd:        0HugePages_Surp:        0Hugepagesize:       2048 kBDirectMap4k:       10232 kBDirectMap2M:      897024 kB</code></pre><h2 id="测试准备"><a href="#测试准备" class="headerlink" title="测试准备"></a>测试准备</h2><pre><code>1. 测试工具：jmeter 4.0；2. 测试数据：csv 100w；3. 线程组：500并发，60秒增长时间，600秒持续时间。</code></pre><h2 id="测试结果一"><a href="#测试结果一" class="headerlink" title="测试结果一"></a>测试结果一</h2><pre><code>未开启TIME_WAIT重用，FIN_WAIT_2状态时间为60</code></pre><h3 id="聚合分析"><a href="#聚合分析" class="headerlink" title="聚合分析"></a>聚合分析</h3><p><img src="https://i.imgur.com/dS29AV5.png" alt=""><br><img src="https://i.imgur.com/eJTZ9u2.png" alt=""></p><h3 id="响应时长"><a href="#响应时长" class="headerlink" title="响应时长"></a>响应时长</h3><p><img src="https://i.imgur.com/2k9DUsY.png" alt=""></p><h2 id="测试结果二"><a href="#测试结果二" class="headerlink" title="测试结果二"></a>测试结果二</h2><pre><code>开启TIME_WAIT重用，FIN_WAIT_2状态时间为30</code></pre><h3 id="聚合分析-1"><a href="#聚合分析-1" class="headerlink" title="聚合分析"></a>聚合分析</h3><p><img src="https://i.imgur.com/29x2Idw.png" alt=""><br><img src="https://i.imgur.com/4vLS2uA.png" alt=""></p><h3 id="响应时长-1"><a href="#响应时长-1" class="headerlink" title="响应时长"></a>响应时长</h3><p><img src="https://i.imgur.com/ZMkoGuB.png" alt=""></p><h1 id="数据库访问情况"><a href="#数据库访问情况" class="headerlink" title="数据库访问情况"></a>数据库访问情况</h1><hr><h3 id="T-REGINFOHIS表"><a href="#T-REGINFOHIS表" class="headerlink" title="T_REGINFOHIS表"></a>T_REGINFOHIS表</h3><ul><li>数据量：4884369</li><li><p>表结构</p><pre><code>CREATE TABLE `T_REGINFOHIS` (  `hisid` bigint(16) NOT NULL AUTO_INCREMENT,  `addtime` datetime DEFAULT NULL,  `opuidtype` char(1) DEFAULT NULL,  `uidnumber` varchar(16) DEFAULT NULL,  `regphone` varchar(32) DEFAULT NULL,  `subid` bigint(16) DEFAULT NULL,  `regtime` datetime NOT NULL DEFAULT &apos;0000-00-00 00:00:00&apos;,  `regmodule` varchar(16) DEFAULT NULL,  `uidtype` varchar(8) DEFAULT NULL,  `callrestrict` varchar(8) DEFAULT NULL,  `callrecording` varchar(4) DEFAULT NULL,  `anucode` varchar(64) DEFAULT NULL,  `bnucode` varchar(64) DEFAULT NULL COMMENT &apos;被叫放音&apos;,  `calldisplay` varchar(16) DEFAULT NULL,  `productid` int(11) DEFAULT NULL,  `name` varchar(32) DEFAULT NULL,  `cardtype` varchar(32) DEFAULT NULL,  `cardno` varchar(32) DEFAULT NULL,  `calldisplaynouid` varchar(32) DEFAULT NULL,  `unitid` varchar(64) DEFAULT NULL,  `expiretime` datetime DEFAULT NULL,  `logid` bigint(10) DEFAULT NULL,  `uuidinpartner` varchar(64) DEFAULT NULL,  `batchworkid` varchar(36) DEFAULT NULL,  `opuser` varchar(64) DEFAULT NULL,  PRIMARY KEY (`hisid`,`regtime`),  KEY `ind_uidnumber` (`uidnumber`),  KEY `ind_regphone` (`regphone`),  KEY `ind_uuidinpartner` (`uuidinpartner`)) ENGINE=InnoDB AUTO_INCREMENT=5884370 DEFAULT CHARSET=utf8</code></pre></li></ul><h3 id="T-REGINFO表"><a href="#T-REGINFO表" class="headerlink" title="T_REGINFO表"></a>T_REGINFO表</h3><ul><li>数据量：20006</li><li><p>表结构</p><pre><code>CREATE TABLE `T_REGINFO` (  `uidnumber` varchar(16) DEFAULT NULL,  `regphone` varchar(32) DEFAULT NULL,  `subid` bigint(16) NOT NULL AUTO_INCREMENT,  `regtime` datetime DEFAULT NULL,  `regmodule` varchar(16) DEFAULT NULL,  `uidtype` varchar(8) DEFAULT NULL,  `callrestrict` varchar(8) DEFAULT NULL,  `callrecording` varchar(4) DEFAULT NULL,  `anucode` varchar(64) DEFAULT NULL,  `bnucode` varchar(64) DEFAULT NULL COMMENT &apos;被叫放音&apos;,  `calldisplay` varchar(16) DEFAULT NULL,  `productid` int(11) DEFAULT NULL,  `name` varchar(32) DEFAULT NULL,  `cardtype` varchar(32) DEFAULT NULL,  `cardno` varchar(32) DEFAULT NULL,  `calldisplaynouid` varchar(16) DEFAULT NULL,  `unitid` varchar(16) DEFAULT NULL,  `expiretime` datetime DEFAULT NULL,  `uuidinpartner` varchar(64) DEFAULT NULL,  `batchworkid` varchar(36) DEFAULT &apos;&apos;,  `opuser` varchar(64) DEFAULT NULL,  PRIMARY KEY (`subid`),  KEY `ind_reginfo_batchworkid` (`batchworkid`) USING BTREE,  KEY `ind_reginfo_uuidinpartner` (`uuidinpartner`) USING BTREE,  KEY `ind_reginfo_uidnumber` (`uidnumber`),  KEY `ind_reginfo_regphone` (`regphone`)) ENGINE=InnoDB AUTO_INCREMENT=3452188 DEFAULT CHARSET=utf8;</code></pre></li></ul><hr><h3 id="sql语句"><a href="#sql语句" class="headerlink" title="sql语句"></a>sql语句</h3><ul><li><p>写入T_REGINFOHIS</p><pre><code>INSERT INTO T_REGINFOHIS (hisid, addtime, opuidtype, uidnumber, regphone, subid, regtime, regmodule, uidtype, callrestrict, callrecording, anucode, bnucode, calldisplay, productid, name, cardtype, cardno, calldisplaynouid, unitid, expiretime, logid, uuidinpartner, batchworkid, opuser)VALUES (?, now(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)</code></pre></li><li><p>写入T_REGINFO</p><pre><code>INSERT INTO T_REGINFO (subid, uidnumber, regphone, regtime, regmodule, uidtype, callrestrict, callrecording, anucode, bnucode, calldisplay, productid, name, cardtype, cardno, calldisplaynouid, unitid, expiretime, uuidinpartner, batchworkid, opuser)VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)</code></pre></li></ul><hr><h3 id="sql统计结果"><a href="#sql统计结果" class="headerlink" title="sql统计结果"></a>sql统计结果</h3><table style="table-layout:auto"><br>    <tr><br>        <td>用例</td><br>        <td>执行数</td><br>        <td>执行时间</td><br>        <td>最慢</td><br>        <td>时间分布</td><br>        <td>平均时间</td><br>    </tr><br>    <tr><br>        <td>写入T_REGINFOHIS</td><br>        <td>1,000,000</td><br>        <td>33,850,801</td><br>        <td>8,945</td><br>        <td>[310988,441162,157808,86465,3577,0,0,0]</td><br>        <td>33.9</td><br>    </tr><br>    <tr><br>        <td>写入T_REGINFO</td><br>        <td>1,000,000</td><br>        <td>37,210,288</td><br>        <td>8,906</td><br>        <td>[403461,337974,188582,64237,5746,0,0,0]</td><br>        <td>37.2</td><br>    </tr><br></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;性能测试&quot;&gt;&lt;a href=&quot;#性能测试&quot; class=&quot;headerlink&quot; title=&quot;性能测试&quot;&gt;&lt;/a&gt;性能测试&lt;/h1&gt;&lt;hr&gt;
&lt;h2 id=&quot;测试目标&quot;&gt;&lt;a href=&quot;#测试目标&quot; class=&quot;headerlink&quot; title=&quot;测试目标
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2018/04/11/hello-world/"/>
    <id>http://yoursite.com/2018/04/11/hello-world/</id>
    <published>2018-04-11T00:54:16.687Z</published>
    <updated>2018-04-11T00:54:16.687Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
  </entry>
  
</feed>
